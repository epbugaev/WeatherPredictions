# Предсказание погодных условий с помощью гибридных физических нейросетей

Данный репозиторий содержит код ВКР студента БПМИ 213 Бугаева Егора Петровича, стажера-исследователя научно-учебной лаборатории методов анализа больших данных LAMBDA. ВКР выполнена под руководством Бузаева Федора Александровича, Преподавателя ДБДИП ФКН ВШЭ и младшего научного сотрудника LAMBDA.

# Аннотация 
В данной работе исследуются возможности физически информированных нейросетей для предсказания погодных условий. В качестве набора данных для оценки качества и обучения моделей используется датасет [WeatherBench](https://github.com/pangeo-data/WeatherBench). Первая часть работы сконцентрирована на анализе комбинации физически информированного модуля и нейросетевого механизма внимания в работе [WeatherGFT](https://github.com/black-yt/WeatherGFT). Во второй части работы предлагается две новые архитектуры, PredFormerGFT и PI-IAM4VP. Первая является комбинацией физического блока на основе WeatherGFT с нейросетью [PredFormer](https://github.com/yyyujintang/PredFormer), вторая является комбинацией аналогичного физического блока с моделью компьютерного зрения [IAM4VP](https://github.com/seominseok0429/Masked-Autoregressive-Model-for-Weather-Forecasting). Архитектуры демонстрируют улучшение качества в сравнении с оригинальными версиями и выбранными для бейзлайна моделями при предсказании различных погодных переменных на карте, приближенной до южной части Атлантического океана. Эти результаты говорят о высокой эффективности физически информированных модулей на предсказании и применимы в различных задачах, в том числе выборе безопасных путей мореходства.

# Состав репозитория
1. В папке train находятся скрипты обучения, где указаны все гиперпараметры опробованных моделей.
2. В папке Data находятся загрузчики данных, созданные на основе схожих моделей из WeatherGFT. Добавлена возможность подгружать данные с x из нескольких часов, что необходимо для моделей, использующих для предсказания историю погодных состояний. Улучшена скорость подгрузки и настроена загрузка из формата .npz, в котором хранятся исходные данные WeatherBench.
3. В папке Models хранятся версии моделей, настроенные на работу с погодными данными. Использованные источники: PredRNN и SimVP из [OpenSTL](https://github.com/chengtan9907/OpenSTL), [WeatherGFT](https://github.com/black-yt/WeatherGFT), [PredFormer](https://github.com/yyyujintang/PredFormer), [IAM4VP](https://github.com/seominseok0429/Masked-Autoregressive-Model-for-Weather-Forecasting).
4. Папка LitModels содержит train и val функции для различных моделей - из-за разного формата входных данных и особенностей inference части некоторые из моделей имеют свои train/val функции.
5. Папка utils содержит второстепенные функции, необходимые для обучения (поддержка DDP-формата для обучения на нескольких карточках и другие).

# Благодарности
В данной работе использовались мощности суперкомпьютера [HPC НИУ ВШЭ](https://hpc.hse.ru/). Большой вклад в постановку научных вопросов и корректировку хода работы, помимо научного руководителя ВКР Бузаева Федора Александровича, внесли Ратников Федор Дмитриевич и другие сотрудники научно-учебной лаборатории методов анализа больших данных [LAMBDA](https://cs.hse.ru/iai/lambda/), ФКН НИУ ВШЭ.

Структура репозитория базируется на репозитории [WeatherBench](https://github.com/pangeo-data/WeatherBench), однако за ход работы были проведены значительные изменения.
